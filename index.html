```html
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tonfiles Market</title>
  <style>
    :root {
      --bg: #0f1220;
      --card: #171a2a;
      --text: #e8ebff;
      --muted: #9aa3c7;
      --accent: #6ea8ff;
      --accent-2: #7b6cff;
      --btn: #2a2f45;
      --btn-hover: #343a55;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
      --radius: 16px;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: sans-serif;
      background: var(--bg);
      color: var(--text);
      overflow-x: hidden; /* фикс против горизонтального скролла */
    }
    .wrap {
      max-width: 1000px;
      margin: 0 auto;
      padding: 16px;
    }
    .hidden { display: none; }
    h2 { margin: 16px 0; }
    /* Грид для карточек */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 16px;
      width: 100%;
    }
    .card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 14px;
      box-shadow: var(--shadow);
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;
      text-align: center;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      width: 100%;
    }
    .card:hover {
      transform: scale(1.03);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.35);
    }
    .card img {
      width: 100%;
      max-height: 160px;
      object-fit: cover;
      border-radius: 12px;
    }
    .name { font-weight: 600; }
    .price { font-size: 14px; color: var(--muted); }
    .btn {
      padding: 10px 12px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: white;
      border: none;
      font-weight: 700;
      cursor: pointer;
      width: 100%;
      max-width: 180px;
    }
    .btn:disabled {
      background: #22c55e;
      cursor: default;
    }
    /* Баланс */
    .balance {
      text-align: right;
      font-weight: 600;
      margin-bottom: 16px;
    }
    /* Форма добавления */
    .form {
      display: flex;
      flex-direction: column;
      gap: 12px;
      background: var(--card);
      padding: 16px;
      border-radius: var(--radius);
    }
    .form input, .form textarea {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: none;
      outline: none;
      background: #1e2235;
      color: var(--text);
    }
    .form textarea { resize: none; height: 80px; }
    .form img {
      max-width: 100%;
      border-radius: 10px;
      margin-top: 8px;
    }
    /* Навигация снизу */
    nav {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: var(--card);
      display: flex;
      justify-content: space-around;
      padding: 10px 0;
      box-shadow: var(--shadow);
    }
    nav button {
      background: none;
      border: none;
      color: var(--text);
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
    }
    nav button.active { color: var(--accent); }
    /* Сетка для истории покупок */
    .grid-2 {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 16px;
    }
  </style>
</head>
<body>
  <main class="wrap">
    <!-- Главная -->
    <section id="homeTab">
      <div class="balance">Баланс: <span id="balance">1000</span> TON</div>
      <h2>Товары</h2>
      <div class="grid" id="productGrid"></div>
    </section>

    <!-- Добавить -->
    <section id="addTab" class="hidden">
      <h2>Добавить товар</h2>
      <form class="form" id="addForm">
        <input type="text" id="title" placeholder="Название" required>
        <textarea id="description" placeholder="Описание" required></textarea>
        <input type="number" id="price" placeholder="Цена (TON)" required>
        <input type="file" id="imageInput" accept="image/*">
        <img id="preview" class="hidden">
        <button type="submit" class="btn">Опубликовать</button>
      </form>
    </section>

    <!-- Профиль -->
    <section id="profileTab" class="hidden">
      <h2>История покупок</h2>
      <div class="grid-2" id="purchasesGrid"></div>
    </section>
  </main>

  <!-- Нижняя навигация -->
  <nav>
    <button class="active" onclick="switchTab('homeTab', this)">Главная</button>
    <button onclick="switchTab('addTab', this)">Добавить</button>
    <button onclick="switchTab('profileTab', this)">Профиль</button>
  </nav>

  <script>
    let balance = 1000;
    const balanceEl = document.getElementById('balance');
    const productGrid = document.getElementById('productGrid');
    const purchasesGrid = document.getElementById('purchasesGrid');
    let products = [];
    let purchases = [];

    // Переключение вкладок
    function switchTab(tabId, btn) {
      document.querySelectorAll('main section').forEach(s => s.classList.add('hidden'));
      document.getElementById(tabId).classList.remove('hidden');
      document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
    }

    // Рендер товаров
    function renderProducts() {
      productGrid.innerHTML = products.map((p, i) => {
        const bought = purchases.some(pc => pc.title === p.title);
        return `
          <div class="card">
            ${p.image ? `<img src="${p.image}" alt="">` : ""}
            <div class="name">${p.title}</div>
            <div class="price">${p.price} TON</div>
            <button class="btn" onclick="buyProduct(${i})" ${bought ? "disabled" : ""}>
              ${bought ? "Куплено" : "Купить"}
            </button>
          </div>
        `;
      }).join('');
    }

    // Рендер покупок
    function renderPurchases() {
      purchasesGrid.innerHTML = purchases.map(p => `
        <div class="card">
          ${p.image ? `<img src="${p.image}" alt="">` : ""}
          <div class="name">${p.title}</div>
          <div class="price">${p.price} TON</div>
        </div>
      `).join('');
    }

    // Купить товар
    function buyProduct(index) {
      const product = products[index];
      if (balance >= product.price) {
        balance -= product.price;
        balanceEl.textContent = balance;
        purchases.push(product);
        renderProducts();
        renderPurchases();
      } else {
        alert("Недостаточно средств!");
      }
    }

    // Загрузка фото
    const imageInput = document.getElementById("imageInput");
    const preview = document.getElementById("preview");
    imageInput.addEventListener("change", () => {
      const file = imageInput.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = e => {
          preview.src = e.target.result;
          preview.classList.remove("hidden");
        };
        reader.readAsDataURL(file);
      }
    });

    // Добавление товара
    document.getElementById('addForm').addEventListener('submit', e => {
      e.preventDefault();
      const title = document.getElementById('title').value;
      const description = document.getElementById('description').value;
      const price = Number(document.getElementById('price').value);
      const image = preview.src || "";

      products.push({ title, description, price, image });
      renderProducts();
      e.target.reset();
      preview.src = "";
      preview.classList.add("hidden");
      switchTab("homeTab", document.querySelector("nav button"));
    });

    renderProducts();
  </script>
</body>
</html>
```
